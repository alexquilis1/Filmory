<div class="watchlist-container">
  <h2>Your Watchlist</h2>

  <!-- Verificar si el usuario está logueado -->
  <div *ngIf="isLoggedIn; else notLoggedIn">
    <!-- Mostrar la lista de watchlist si hay items -->
    <div *ngIf="watchlist.length > 0; else noItems">
      <div *ngFor="let item of watchlist" class="watchlist-item">
        <!-- Left column: Poster Image -->
        <img *ngIf="item.posterPath" [src]="item.posterPath" alt="Poster" class="item-poster" />

        <!-- Right column: All information (Title, Genres, Release Date, Overview, etc.) -->
        <div class="item-info">
          <h3>{{ item.title }}</h3>

          <p><strong>Genres:</strong> {{ item.genres }}</p>
          <p *ngIf="item.type === 'movie'"><strong>Release Date:</strong> {{ item.releaseDate }}</p>
          <p *ngIf="item.type === 'tv'"><strong>First Air Date:</strong> {{ item.firstAirDate }}</p>
          <p *ngIf="item.type === 'movie'"><strong>Runtime:</strong> {{ item.runtime }} min</p>
          <p *ngIf="item.type === 'tv'"><strong>Seasons:</strong> {{ item.numberOfSeasons }} | <strong>Episodes:</strong> {{ item.numberOfEpisodes }}</p>
          <p *ngIf="item.type === 'tv'"><strong>Status:</strong> {{ item.status }}</p>
          <p *ngIf="item.type === 'tv'"><strong>Average Vote:</strong> {{ item.voteAverage }}</p>

          <p><strong>Overview:</strong> {{ item.overview }}</p>

          <!-- Mostrar detalles de las temporadas para las series -->
          <div *ngIf="item.type === 'tv'">
            <div *ngFor="let season of item.seasons">
              <h4>Season {{ season.seasonNumber }}</h4>
              <p><strong>Episodes:</strong> {{ season.episodeCount }}</p>
            </div>
          </div>

          <!-- Mostrar estado de watched -->
          <p><strong>Watched:</strong> {{ item.watched ? 'Yes' : 'No' }}</p>

          <!-- Fecha de adición -->
          <p><strong>Added on:</strong> {{ item.added_date | date: 'yyyy-MM-dd HH:mm' }}</p>

          <!-- Botones para modificar el estado de watched y eliminar el item -->
          <button (click)="toggleWatchedStatus(item)">Toggle Watched</button>
          <button (click)="removeFromWatchlist(item)">Remove</button>
        </div>
      </div>
    </div>

    <!-- Template para cuando la lista está vacía -->
    <ng-template #noItems>
      <p>Your watchlist is empty.</p>
    </ng-template>
  </div>

  <!-- Template para cuando el usuario no está logueado -->
  <ng-template #notLoggedIn>
    <p>You need to log in to view your watchlist.</p>
  </ng-template>
</div>
